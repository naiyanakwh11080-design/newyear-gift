<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>üéÅ ‡∏à‡∏±‡∏ö‡∏â‡∏•‡∏≤‡∏Å‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà</title>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;500;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
body{
  font-family:'Prompt',sans-serif;
  margin:0;
  background:linear-gradient(#0f2027,#203a43,#2c5364);
  color:#fff;
}
.container{
  max-width:1100px;
  margin:40px auto;
  background:#ffffff;
  color:#333;
  border-radius:20px;
  padding:30px;
  box-shadow:0 25px 50px rgba(0,0,0,.4);
}
h1{text-align:center;color:#cfae70;}
button{
  font-size:20px;
  padding:12px 30px;
  border:none;
  border-radius:40px;
  cursor:pointer;
  margin:10px;
}
.random{background:#d4af37;color:#fff;}
.reset{background:#c0392b;color:#fff;}
#result{
  font-size:30px;
  text-align:center;
  color:#b22222;
  margin:20px 0;
}
textarea{
  width:100%;
  height:300px;
  border-radius:15px;
  padding:15px;
}
.history{
  background:#f7f7f7;
  border-radius:15px;
  padding:15px;
  max-height:250px;
  overflow:auto;
}
.count{text-align:center;font-size:18px;margin-bottom:10px;}
footer{text-align:center;margin-top:20px;color:#777;}
canvas#snow{position:fixed;top:0;left:0;pointer-events:none;}
</style>
</head>

<body>
<canvas id="snow"></canvas>

<div class="container">
<h1>üéÑ ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°‡∏à‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà üéÅ</h1>

<div style="text-align:center">
<button class="random" onclick="draw()">üé≤ ‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</button>
<button class="reset" onclick="resetAll()">üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
</div>

<div id="result"></div>
<div class="count" id="count"></div>

<h3>üìã ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠</h3>
<textarea id="names">
‡∏ô‡∏≤‡∏¢‡∏Ñ‡∏°‡∏Å‡∏§‡∏© ‡∏ß‡∏¥‡πÄ‡∏®‡∏©
‡∏ô‡∏≤‡∏¢‡∏≠‡∏±‡∏©‡∏é‡∏≤‡∏ß‡∏∏‡∏ò ‡∏™‡∏≠‡∏ô‡∏û‡∏£‡∏´‡∏°
‡∏ô‡∏≤‡∏á‡∏ì‡∏†‡∏±‡∏ó‡∏£ ‡∏ô‡∏≤‡∏ä‡∏±‡∏¢‡πÄ‡∏á‡∏¥‡∏ô
‡∏ô‡∏≤‡∏¢‡∏õ‡∏è‡∏¥‡∏û‡∏á‡∏©‡πå ‡∏®‡∏£‡∏µ‡∏ß‡∏¥‡∏ö‡∏π‡∏•‡∏¢‡πå
‡∏ô‡∏™.‡∏ß‡∏ô‡∏¥‡∏ä‡∏ô‡∏Å ‡∏´‡∏á‡∏©‡πå‡πÄ‡∏≠‡∏Å
‡∏ô‡∏™.‡∏ö‡∏∏‡∏©‡∏Å‡∏£ ‡∏®‡∏£‡∏µ‡∏ä‡∏±‡∏¢‡∏ä‡∏¥‡∏ï
‡∏ô‡∏™.‡∏ß‡∏≤‡∏£‡∏µ ‡∏™‡∏∏‡∏î‡∏Å‡∏£‡∏¢‡∏∏‡∏ó‡∏ò‡πå
‡∏ô‡∏≤‡∏¢‡∏ì‡∏ò‡∏Å‡∏£ ‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡πå‡∏à‡∏¥‡∏£‡πÄ‡∏î‡∏ä
‡∏ô‡∏≤‡∏¢‡∏ä‡∏±‡∏¢‡∏ì‡∏£‡∏á‡∏Ñ‡πå ‡πÑ‡∏Å‡∏£‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå
‡∏ô‡∏™.‡∏ö‡∏∏‡∏©‡∏£‡∏≤‡∏Ñ‡∏±‡∏° ‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡πå‡∏à‡∏¥‡∏£‡πÄ‡∏î‡∏ä
‡∏ô‡∏™.‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏≤ ‡∏ß‡∏£‡πÄ‡∏ß‡∏ä‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏≤
‡∏ô‡∏≤‡∏¢‡∏û‡∏∏‡∏ó‡∏ò‡∏û‡∏• ‡∏ç‡∏≤‡∏ï‡∏¥‡∏õ‡∏£‡∏≤‡πÇ‡∏°‡∏ó‡∏¢‡πå
‡∏ô‡∏≤‡∏á‡∏ß‡∏£‡∏±‡∏ç‡∏ç‡∏≤ ‡∏ç‡∏≤‡∏ï‡∏¥‡∏õ‡∏£‡∏≤‡πÇ‡∏°‡∏ó‡∏¢‡πå
‡∏ô‡∏™.‡∏™‡∏≤‡∏¢‡∏ù‡∏ô ‡∏à‡∏¥‡∏ï‡∏õ‡∏£‡∏µ‡∏î‡∏≤
‡∏ô‡∏™.‡∏ò‡∏µ‡∏£‡∏≤‡∏£‡∏±‡∏ï‡∏ô‡πå ‡∏Ñ‡∏π‡∏®‡∏£‡∏µ‡∏£‡∏±‡∏ï‡∏ô‡πå
‡∏ô‡∏™.‡∏™‡∏∏‡∏•‡∏≤‡∏ß‡∏±‡∏ì‡∏¢‡πå ‡∏ß‡∏£‡∏£‡∏ì‡πÇ‡∏Ñ‡∏ï‡∏£
‡∏ô‡∏≤‡∏á‡∏Å‡∏¥‡∏ï‡∏ï‡∏¥‡∏¢‡∏≤‡∏û‡∏£ ‡∏≠‡∏∏‡∏ó‡∏£‡∏±‡∏Å‡∏©‡πå
‡∏ô‡∏≤‡∏¢‡∏™‡∏¢‡∏°‡∏û‡∏• ‡∏≠‡∏≤‡∏•‡∏±‡∏¢
‡∏ô‡∏≤‡∏¢‡∏™‡∏∏‡∏ä‡∏ô ‡∏≠‡∏∏‡∏ó‡∏±‡∏¢‡∏ä‡∏¥‡∏ï
‡∏ô‡∏™.‡∏û‡∏ô‡∏¥‡∏™‡∏ï‡∏≤‡∏û‡∏£ ‡∏Ç‡∏±‡∏ô‡∏ò‡∏ö‡∏π‡∏£‡∏ì‡πå
‡∏ô‡∏≤‡∏á‡∏û‡∏£‡∏£‡∏ì‡∏ó‡∏¥‡∏û‡∏¢‡πå ‡∏ß‡∏£‡∏£‡∏ì‡∏Ç‡∏≤‡∏ß
‡∏ô‡∏≤‡∏á‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡∏û‡∏£ ‡∏â‡∏≤‡∏¢‡∏∞‡πÇ‡∏Ñ‡∏ï‡∏£
‡∏ô‡∏≤‡∏á‡∏≠‡∏î‡∏¥‡∏®‡∏£ ‡∏≠‡∏∏‡∏î‡∏£‡∏ó‡∏±‡∏Å‡∏©‡πå
‡∏ô‡∏™.‡∏™‡∏±‡∏á‡∏ß‡∏≤‡∏•‡∏¢‡πå ‡πÄ‡∏û‡∏£‡∏¥‡∏î‡∏û‡∏£‡∏≤‡∏ß
‡∏ô‡∏≤‡∏á‡∏ò‡∏±‡∏ç‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå ‡πÑ‡∏ä‡∏¢‡∏™‡∏∏‡∏Ç ‡∏°‡∏≠‡∏•‡πÄ‡∏•‡∏≠‡∏£‡πå‡∏£‡∏û
‡∏ô‡∏≤‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡∏ó‡∏¥‡∏ï ‡πÄ‡∏û‡∏µ‡∏¢‡∏£‡∏†‡∏≤‡∏¢‡∏•‡∏∏‡∏ô
‡∏ô‡∏™.‡∏£‡∏±‡∏Å‡∏ä‡∏ô‡∏Å ‡∏ñ‡∏ß‡∏¥‡∏•‡∏Å‡∏≤‡∏£
‡∏ô‡∏≤‡∏á‡∏ô‡∏¥‡πà‡∏°‡∏ô‡∏ß‡∏• ‡∏´‡∏≤‡∏ç‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå
‡∏ô‡∏≤‡∏á‡∏õ‡∏≤‡∏£‡∏¥‡∏ä‡∏≤‡∏ï‡∏¥ ‡∏ß‡∏¥‡∏ä‡∏±‡∏¢‡πÇ‡∏¢
‡∏ô‡∏≤‡∏á‡∏ì‡∏±‡∏è‡∏ê‡∏û‡∏£ ‡∏¢‡∏µ‡πà‡∏ß‡∏≤‡∏®‡∏£‡∏µ
...
(‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡πÉ‡∏™‡πà‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß)
</textarea>

<h3>‚úÖ ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß</h3>
<div class="history" id="history"></div>

<footer>‚ú® ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô ‚ú®</footer>
</div>

<script>
let history=[];
let original="";
const SHEET_URL="‡πÉ‡∏™‡πà_URL_Apps_Script_‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà";

window.onload=()=>{
 original=document.getElementById("names").value;
 updateCount();
 snow();
};

function draw(){
 let t=document.getElementById("names");
 let arr=t.value.split("\n").filter(x=>x.trim());
 if(arr.length===0){
  document.getElementById("result").innerHTML="üéâ ‡∏à‡∏±‡∏ö‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡πÅ‡∏•‡πâ‡∏ß";
  return;
 }
 let i=Math.floor(Math.random()*arr.length);
 let name=arr[i];

 document.getElementById("result").innerHTML="üéÅ ‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç<br><b>"+name+"</b>";
 history.push(name);
 arr.splice(i,1);
 t.value=arr.join("\n");

 updateHistory();
 updateCount();
 firework();
 saveToSheet(name);
}

function saveToSheet(name){
 fetch(SHEET_URL,{
  method:"POST",
  body:JSON.stringify({name:name}),
  headers:{'Content-Type':'application/json'}
 });
}

function updateHistory(){
 document.getElementById("history").innerHTML=
 history.map((n,i)=>`${i+1}. ${n}`).join("<br>");
}
function updateCount(){
 let c=document.getElementById("names").value.split("\n").filter(x=>x.trim()).length;
 document.getElementById("count").innerHTML="üë• ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏µ‡∏Å "+c+" ‡∏Ñ‡∏ô";
}
function resetAll(){
 if(confirm("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà")){
  document.getElementById("names").value=original;
  history=[];
  document.getElementById("history").innerHTML="";
  document.getElementById("result").innerHTML="";
  updateCount();
 }
}
function firework(){
 confetti({particleCount:150,spread:120,origin:{y:0.6}});
}
function snow(){
 const c=document.getElementById("snow"),ctx=c.getContext("2d");
 c.width=window.innerWidth;c.height=window.innerHeight;
 let flakes=[...Array(100)].map(()=>({x:Math.random()*c.width,y:Math.random()*c.height,r:Math.random()*3+1}));
 function draw(){
  ctx.clearRect(0,0,c.width,c.height);
  ctx.fillStyle="white";
  flakes.forEach(f=>{
   ctx.beginPath();
   ctx.arc(f.x,f.y,f.r,0,Math.PI*2);
   ctx.fill();
   f.y+=f.r;
   if(f.y>c.height)f.y=0;
  });
  requestAnimationFrame(draw);
 }
 draw();
}
</script>
</body>
</html>
