<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>üé° ‡∏ß‡∏á‡∏•‡πâ‡∏≠‡∏à‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà</title>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
body{
 font-family:'Prompt',sans-serif;
 background:radial-gradient(circle,#001f3f,#000814);
 color:#fff;
 text-align:center;
 margin:0;
 padding:20px;
}
h1{color:#f1c40f;}
canvas{
 background:#fff;
 border-radius:50%;
 margin-top:20px;
 box-shadow:0 0 25px rgba(255,255,255,.3);
}
button{
 font-size:20px;
 padding:12px 30px;
 border:none;
 border-radius:30px;
 margin:15px;
 cursor:pointer;
}
.spin{background:#f1c40f;}
.reset{background:#e74c3c;color:#fff;}
#result{
 font-size:30px;
 margin-top:20px;
 color:#ffeb3b;
}
</style>
</head>
<body>

<h1>üéÑ ‡∏ß‡∏á‡∏•‡πâ‡∏≠‡∏™‡∏∏‡πà‡∏°‡∏à‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà üéÅ</h1>

<canvas id="wheel" width="500" height="500"></canvas><br>

<button class="spin" onclick="spin()">üé° ‡∏´‡∏°‡∏∏‡∏ô‡∏ß‡∏á‡∏•‡πâ‡∏≠ (10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)</button>
<button class="reset" onclick="resetWheel()">üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>

<div id="result"></div>

<!-- üîä ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏û‡∏•‡∏∏ -->
<audio id="fireSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_6e7b0d3d9c.mp3"></audio>

<script>
/* ================== ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ ================== */
const SPIN_TIME = 10000; // 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
const SHEET_URL = "https://docs.google.com/spreadsheets/d/1p-vSX-u8YdjAKFAFJxiNKCRaOD4qjgXtp4ScWp2SbjY/edit?gid=0#gid=0";

/* ================== ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ ================== */
let names = [
 "‡∏ô‡∏≤‡∏¢‡∏Ñ‡∏°‡∏Å‡∏§‡∏© ‡∏ß‡∏¥‡πÄ‡∏®‡∏©","‡∏ô‡∏≤‡∏¢‡∏≠‡∏±‡∏©‡∏é‡∏≤‡∏ß‡∏∏‡∏ò ‡∏™‡∏≠‡∏ô‡∏û‡∏£‡∏´‡∏°","‡∏ô‡∏≤‡∏á‡∏ì‡∏†‡∏±‡∏ó‡∏£ ‡∏ô‡∏≤‡∏ä‡∏±‡∏¢‡πÄ‡∏á‡∏¥‡∏ô",
 "‡∏ô‡∏≤‡∏¢‡∏õ‡∏è‡∏¥‡∏û‡∏á‡∏©‡πå ‡∏®‡∏£‡∏µ‡∏ß‡∏¥‡∏ö‡∏π‡∏•‡∏¢‡πå","‡∏ô‡∏™.‡∏ß‡∏ô‡∏¥‡∏ä‡∏ô‡∏Å ‡∏´‡∏á‡∏©‡πå‡πÄ‡∏≠‡∏Å",
 "‡∏ô‡∏™.‡∏ö‡∏∏‡∏©‡∏Å‡∏£ ‡∏®‡∏£‡∏µ‡∏ä‡∏±‡∏¢‡∏ä‡∏¥‡∏ï","‡∏ô‡∏™.‡∏ß‡∏≤‡∏£‡∏µ ‡∏™‡∏∏‡∏î‡∏Å‡∏£‡∏¢‡∏∏‡∏ó‡∏ò‡πå",
 // üëâ ‡πÉ‡∏™‡πà‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ (‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î)
];

let original = [...names];
let canvas = document.getElementById("wheel");
let ctx = canvas.getContext("2d");
let angle = 0;
let spinning = false;

/* ================== ‡∏ß‡∏≤‡∏î‡∏ß‡∏á‡∏•‡πâ‡∏≠ ================== */
function drawWheel(){
 if(names.length === 0){
  ctx.clearRect(0,0,500,500);
  return;
 }
 let slice = 2*Math.PI/names.length;
 ctx.clearRect(0,0,500,500);

 names.forEach((name,i)=>{
  ctx.beginPath();
  ctx.fillStyle = `hsl(${i*360/names.length},70%,60%)`;
  ctx.moveTo(250,250);
  ctx.arc(250,250,240,angle+i*slice,angle+(i+1)*slice);
  ctx.fill();

  ctx.save();
  ctx.translate(250,250);
  ctx.rotate(angle+(i+0.5)*slice);
  ctx.textAlign="right";
  ctx.fillStyle="#000";
  ctx.font="16px Prompt";
  ctx.fillText(name,230,5);
  ctx.restore();
 });
}
drawWheel();

/* ================== ‡∏´‡∏°‡∏∏‡∏ô‡∏ß‡∏á‡∏•‡πâ‡∏≠ ================== */
function spin(){
 if(spinning || names.length===0) return;
 spinning = true;
 let start = Date.now();

 let timer = setInterval(()=>{
  let t = Date.now()-start;
  angle += 0.35*(1-t/SPIN_TIME);
  drawWheel();

  if(t >= SPIN_TIME){
   clearInterval(timer);
   spinning = false;
   pickWinner();
  }
 },20);
}

/* ================== ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ ================== */
function pickWinner(){
 let slice = 2*Math.PI/names.length;
 let index = Math.floor(((2*Math.PI-angle)%(2*Math.PI))/slice);
 let winner = names[index];

 document.getElementById("result").innerHTML =
  "üéâ ‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç üéâ<br><b>"+winner+"</b>";

 // ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå + ‡πÄ‡∏™‡∏µ‡∏¢‡∏á
 document.getElementById("fireSound").play();
 confetti({particleCount:200,spread:120});

 saveToSheet(winner);

 names.splice(index,1);
 drawWheel();
}

/* ================== ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï ================== */
function resetWheel(){
 if(confirm("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ß‡∏á‡∏•‡πâ‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")){
  names = [...original];
  angle = 0;
  document.getElementById("result").innerHTML="";
  drawWheel();
 }
}

/* ================== ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Google Sheets ================== */
function saveToSheet(name){
 fetch(SHEET_URL,{
  method:"POST",
  body:JSON.stringify({name:name}),
  headers:{'Content-Type':'application/json'}
 });
}
</script>

</body>
</html>

